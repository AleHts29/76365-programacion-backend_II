{{!--
El primer campo input deberá ser el nombre del cliente.
El segundo campo input deberá contener el correo electrónico
El botón getCookie debe enviar una petición de tipo GET para recibir la cookie, solo mostrar por consola la cookie.


--

El botón submit, deberá enviar una petición POST, la cual deberá crear una cookie con el formato
{user:correoDelInput}
La cookie debe tener un tiempo de vida de 10 segundos. Corroborar que la cookie se borre después del tiempo indicado.

--}}





<h1>Datos de prueba Cookies</h1>

<div>
    <form id="clienteForm">
        <label for="nombre"> Nombre del cliente</label>
        <input type="text" id="nombre" name="nombre">
        <br>
        <label for="correo"> Correo del cliente</label>
        <input type="email" id="correo" name="correo">
        <br>
        <button type="submit">Submit</button>
        <button type="button" onclick="getCookie()">Get Cookie</button>
    </form>
</div>

{{!-- Script JS - Debe ir en un archivo separado --}}
<script>




    let formData = document.getElementById('clienteForm')

    formData.addEventListener('submit', function (e) {
        e.preventDefault()

        const nombre = document.getElementById('nombre').value;
        const correo = document.getElementById('correo').value;

        fetch('http://localhost:9090/set-cookie', {
            method: "POST",
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ nombre, correo })
        })
            .then(response => {
                // suponemos que server devuelve la cookie como texto o JSON
                return response.text()
            })
            .then(msg => {
                console.log("mensaje", msg);
            })
            .catch(error => {
                console.log("Error al obntener la cookie: ", error)
            });

    })





    function getCookie() {
        // debemos hacer un fetch a las APIs
        fetch('http://localhost:9090/getCookie', {
            method: 'GET',
            credentials: 'include' // para incluir cookies en la solicitud
        })
            .then(response => {
                // suponemos que server devuelve la cookie como texto o JSON
                return response.text()
            })
            .then(cookie => {
                console.log("Cookie recibida:", cookie);
            })
            .catch(error => {
                console.log("Error al obntener la cookie: ", error)
            });
    }
</script>